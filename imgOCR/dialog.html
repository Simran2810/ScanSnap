<div class="ocrext-element ocrext-wrapper">
  <header class="ocrext-element ocrext-header">
	<span class="ocrext-element ocrext-title mdl-layout-title">
    <span>Scansnap</span>
    <a class="ocrext-closeToolbar-link icon-action-white icon-action-white-ic_close_white_24dp" title="Close"></a>
    <a class="ocrext-settings-link icon-action-white icon-action-white-ic_settings_white_24dp" title="Settings"></a>
  </span>
  </header>
  <div class="ocrext-element ocrext-content ocrext-clearfix">
    <div class="ocrext-element ocrext-canvas-container">
      <canvas id="ocrext-canOrig" class="ocrext-element" width="480" height="320" style="display: none;"></canvas>
      <canvas id="ocrext-can" class="ocrext-element" width=480 height=320></canvas>
      <div class="ocrext-element ocrext-textoverlay-container">
        <a class="ocrext-close-link" title="Close"></a>
      </div>
    </div>
    <div class="ocrext-element ocrext-ocr-output">
      <div class="ocrext-element ocrext-spinner-wrapper">
        <div class="ocrext-element mdl-spinner mdl-js-spinner ocrext-spinner"></div>
      </div>
      <p class="ocrext-element ocrext-status"></p>
      <div class="ocrext-element ocrext-grid ocrext-grid-message ocrext-clearfix">
        <div class="ocrext-element ocrext-cell ocrext-cell-small">
          <h5 class="ocrext-element ocrext-label ocrext-message">OCR Result<span></span></h5> 
        </div>
        <div class="ocrext-element ocrext-cell ocrext-cell-large">
          <textarea class="ocrext-element ocrext-ocr-message ocrext-result" id="result">N/A</textarea>
        </div>
      </div>
      
      
    </div>
    <div class="ocrext-element ocrext-footer mdl-grid">
      <div class="ocrext-element mdl-cell mdl-cell--3-col ocrext-quickselect-btn-container">
      </div>
      <!-- <div class="ocrext-element mdl-cell mdl-cell--1-col">
      </div> -->
      <div class="ocrext-element mdl-cell mdl-cell--9-col ocrext-btn-container">
        <button class="ocrext-element ocrext-ocr-sendocr ocrext-btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" title="Redo OCR">Redo OCR</button>
         <label>Choose voice</label>
      <select id="voices"></select>
        <button class="ocrext-element ocrext-ocr-ts ocrext-btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" title="Redo OCR">Text to Speech</button>
        <input type="text" name="filename" id="filename">
        <button onclick="onExportToDoc()" class="ocrext-element ocrext-ocr-export ocrext-btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" title="Redo OCR">Export to doc</button>
        <button class="ocrext-element ocrext-ocr-recapture ocrext-btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" title="Recapture">Re-Capture</button>
        <button class="ocrext-element ocrext-ocr-copy ocrext-btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" title="Copy to clipboard">Copy to clipboard</button>
      </div>
    </div>
    
  </div>
</div>
<script type="text/javascript">
document.getElementsByClassName("ocrext-ocr-export")[0].addEventListener("click", onExportToDoc);

function onExportToDoc()
{
    var textToSave = document.getElementsByClassName("ocrext-result")[0].value;
    var textToSaveAsBlob = new Blob([textToSave], {type:"docx/plain"});
    var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
    var fileNameToSaveAs = document.getElementById("filename").value;
    // var fileNameToSaveAs = "yingying";
 
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    downloadLink.href = textToSaveAsURL;
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink); 
    downloadLink.click();
}
 
function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}
</script>